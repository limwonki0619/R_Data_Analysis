theme_clean()
ggplot(data, aes(x="",y=share, fill=version)) +
geom_bar(stat="identity", width = 1) +
coord_polar(theta = "y") +
xlim(0,4)
ggplot(data, aes(x="",y=share, fill=version)) +
geom_bar(stat="identity", width = 1) +
coord_polar(theta = "y") +
xlim(0,4)
p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE)
p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme_clean()
p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE)
p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank())
p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(),
axis.text = element_blank())
p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(),
axis.text = element_blank(),
panel.background = element_blank())
p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(),
axis.text = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
data2=ddply(dat1,"browser",summarize,sum(share))
library(dplyr)
data2=ddply(dat1,"browser",summarize,sum(share))
library(plyr)
data2=ddply(dat1,"browser",summarize,sum(share))
colnames(data2)[2]="sum"
data2=data2[order(data2$sum,decreasing=TRUE),]
data2$cumsum=cumsum(data2$sum)
data2$pos=data2$cumsum-data2$sum/2
data2$ymin=data2$cumsum-data2$sum
data2$ratio=data2$sum*100/sum(data2$sum)
data2
data3 <- ddply(dat1,"browser",summarize,sum(share))
data3
dat1 %>%
group_by("browser") %>%
transmute(sum = sum(share))
dat1 %>%
group_by(browser) %>%
transmute(sum = sum(share))
data3
dat1 %>%
group_by(browser) %>% unique() %>%
transmute(sum = sum(share))
dat1 %>%
group_by(browser) %>%
mutate(sum = sum(share))
dat1 %>%
group_by(browser) %>%
transform(sum = sum(share))
dat1 %>%
group_by(browser) %>%
transmute(sum = sum(share))
dat1 %>%
select(browser, share) %>%
group_by(browser) %>%
transmute(sum = sum(share))
dat1 %>%
group_by(browser) %>%
transmute(sum = sum(share))
data3
dat1 %>%
group_by(browser) %>%
summarise(sum = sum(share))
dat1 %>%
group_by(browser)
dat1 %>%
group_by(browser) %>%
summarise(sum = sum(share))
dat1 %>%
group_by(browser) %>%
transmute(sum = sum(share))
dat1 %>%
group_by(browser) %>%
transmute(sum = sum(share),
cumsum = cumsum(sum))
data2 <- ddply(dat1,"browser",summarize,sum(share))
colnames(data2)[2]="sum"
data2=data2[order(data2$sum,decreasing=TRUE),]
data2$cumsum=cumsum(data2$sum)
data2$pos=data2$cumsum-data2$sum/2
data2$ymin=data2$cumsum-data2$sum
data2$ratio=data2$sum*100/sum(data2$sum)
data2
dat1 %>% select(browser, share)
dat1 %>% select(browser, share) %>%
group_by(browser) %>%
transmute(sum = sum(share),
cumsum = cumsum(sum))
dat1 %>% select(browser, share)
dat1 %>%
group_by(as.factor(browser)) %>%
transmute(sum = sum(share),
cumsum = cumsum(sum))
dat1 %>%
group_by(browser) %>%
transmute(sum = sum(share),
cumsum = cumsum(sum))
dat1 %>%
group_by(browser) %>%
summarise_each(funs = sum, share),
cumsum = cumsum(sum))
dat1 %>%
group_by(browser) %>%
summarise_each(funs(sum), share),
cumsum = cumsum(sum))
dat1 %>%
group_by(browser) %>%
summarise_each(funs(sum), share),
cumsum = cumsum(sum)
dat1 %>%
group_by(browser) %>%
summarise_each(funs(sum), share)
dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), share)
dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share)
data2
dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc())
dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum))
dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum))
dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
data2 <- dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
p2 <- p1 +
ggplot(data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum, fill=browser)) +
geom_text(data2, aes(x=1.5, y=pos, label=borwser))
p2 <- p1 +
geom_rect(data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum, fill=browser)) +
geom_text(data2, aes(x=1.5, y=pos, label=borwser))
p1
p2 <- p1 +
geom_rect(data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=browser)) +
geom_text(data2, aes(x=1.5, y=pos, label=browser))
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=browser)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
p<-p+geom_rect(data=data2,aes(xmin=0,xmax=3,ymin=ymin,ymax=cumsum,fill=browser, alpha=0.3))+
geom_text(data=data2,aes(x=1.5,y=pos,label=browser))
p <- ggplot(dat1)+geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax,fill=version, alpha=0.3))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
data2 <- dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=browser)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=browser, alpha=0.3)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
p <- ggplot(dat1)+geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=rainbow(7), alpha=0.7)))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
data2 <- dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=rainbow(7), alpha=0.7)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
p <- ggplot(dat1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=rainbow(nrow(dat1)), alpha=0.7))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
data2 <- dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=rainbow(nrow(dat1)), alpha=0.7)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
rainbow(nrow(dat1))
p <- ggplot(dat1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=rainbow(nrow(dat1)), alpha=0.7))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
p1
data2 <- dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=rainbow(nrow(dat1)), alpha=0.7)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
data2
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=rainbow(nrow(data2)), alpha=0.7)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
p <- ggplot(dat1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=browser, alpha=0.7))
dat1
as.factor(browser)
p <- ggplot(dat1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=grouping(browser), alpha=0.7))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
p1
grouping(browser)
grouping(dat1$browser)
group_by(dat1$browser)
groups(dat1$browser)
p <- ggplot(dat1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=groups(browser), alpha=0.7))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
p1
p <- ggplot(dat1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=groups(as.factor(browser)), alpha=0.7))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
p1
p <- ggplot(dat1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=browser, alpha=0.7))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
)
p1
data2 <- dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=browser, alpha=0.7)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
p <- ggplot(dat1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=browser, alpha=0.7))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
legend.position = "neon"
)
p1
data2 <- dat1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=browser, alpha=0.7)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
dat1
dat1 %>%
mutate(ymax = cumsum(share))
dat1 <- data.frame(browser = c("MSIE","MSIE","MSIE","MSIE","Firefox","Firefox","Firefox","Chrome","Safari","Safari","Opera"),
version = c("MSIE 6.0","MSIE 7.0","MSIE 8.0","MSIE 9.0","Firefox 3.5","Firefox 3.6","Firefox 4.0","Chrome 10.0","Safari 4.0","Safari 5.0","Opera 11.x"),
share = c(10.35, 7.35, 33.06, 2.81, 1.58, 13.12, 5.43, 9.91, 1.42, 4.55, 1.65))
dat1 %>%
mutate(ymax = cumsum(share))
dat1 %>%
mutate(ymax = cumsum(share),
ymin = cumsum(share)-share)
dat1 %>%
mutate(ymax = cumsum(share),
ymin = cumsum(share)-share,
ypos = ymin + (share/2),
ratio = share / sum(share) * 100)
dat1$ymax<-cumsum(dat1$share)
data <- dat1 %>%
mutate(ymax = cumsum(share),
ymin = cumsum(share)-share,
ypos = ymin + (share/2),
ratio = share / sum(share) * 100)
data
p <- ggplot(data)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=browser, alpha=0.7))
p1 <- p + coord_polar(theta = "y") +
xlim(0,4) +
geom_text(aes(x=3.5,y=ypos+1,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(), # 축 타이틀 삭제
axis.text = element_blank(),  # 축 텍스트 삭제
axis.ticks = element_blank(), # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
legend.position = "neon"
)
p1
data2 <- data %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
p2 <- p1 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=browser, alpha=0.7)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p2
p <- ggplot(data1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=browser, alpha=0.7))
data <- data.frame(browser = c("MSIE","MSIE","MSIE","MSIE","Firefox","Firefox","Firefox","Chrome","Safari","Safari","Opera"),
version = c("MSIE 6.0","MSIE 7.0","MSIE 8.0","MSIE 9.0","Firefox 3.5","Firefox 3.6","Firefox 4.0","Chrome 10.0","Safari 4.0","Safari 5.0","Opera 11.x"),
share = c(10.35, 7.35, 33.06, 2.81, 1.58, 13.12, 5.43, 9.91, 1.42, 4.55, 1.65))
data1 <- data %>%
mutate(ymax = cumsum(share),
ymin = cumsum(share)-share,
ypos = ymin + (share/2),
ratio = share / sum(share) * 100)
p <- ggplot(data1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=browser, alpha=0.7))
p
data <- data.frame(browser = c("MSIE","MSIE","MSIE","MSIE","Firefox","Firefox","Firefox","Chrome","Safari","Safari","Opera"),
version = c("MSIE 6.0","MSIE 7.0","MSIE 8.0","MSIE 9.0","Firefox 3.5","Firefox 3.6","Firefox 4.0","Chrome 10.0","Safari 4.0","Safari 5.0","Opera 11.x"),
share = c(10.35, 7.35, 33.06, 2.81, 1.58, 13.12, 5.43, 9.91, 1.42, 4.55, 1.65))
data1 <- data %>%
mutate(ymax = cumsum(share),
ymin = cumsum(share)-share,
ypos = ymin + (share/2),
ratio = share / sum(share) * 100)
p <- ggplot(data1)+
geom_rect(aes(xmin=3,xmax=4,ymin=ymin,ymax=ymax, fill=browser, alpha=0.7))
p
p1 <- p +
coord_polar(theta = "y") +
xlim(0,4)
p1
p2 <- p1
geom_text(aes(x=3.5,y=ypos+1,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(),       # 축 타이틀 삭제
axis.text = element_blank(),        # 축 텍스트 삭제
axis.ticks = element_blank(),       # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
legend.position = "neon"            # 범례삭제
)
p2 <- p1 +
geom_text(aes(x=3.5,y=ypos+1,label=version))+
guides(fill=FALSE) +
theme(axis.title = element_blank(),       # 축 타이틀 삭제
axis.text = element_blank(),        # 축 텍스트 삭제
axis.ticks = element_blank(),       # 축 ticks  삭제
panel.background = element_blank(), # 패널 배경 삭제
legend.position = "neon"            # 범례삭제
)
p2
data2 <- data1 %>%
group_by(browser) %>%
summarise_each(list(sum), sum = share) %>%
arrange(desc(sum)) %>%
mutate(cumsum = cumsum(sum),
pos = cumsum - (sum/2),
ymin = cumsum - sum,
ratio = sum/sum(sum)*100)
p3 <- p2 +
geom_rect(data=data2, aes(xmin=0, xmax=3, ymin=ymin, ymax=cumsum,fill=browser, alpha=0.7)) +
geom_text(data=data2, aes(x=1.5, y=pos, label=browser))
p3
