TS <- data.frame(date = seq(as.Date("2012-01-01"), as.Date("2019-01-01"), by="month"),
value = c(runif(30, -.5, 0), rurunif(45,0,1)))
TS <- data.frame(date = seq(as.Date("2012-01-01"), as.Date("2019-01-01"), by="month"),
value = c(runif(30, -.5, 0), runif(45,0,1)))
TS <- data.frame(date = seq(as.Date("2012-01-01"), as.Date("2019-01-01"), by="month"),
value = c(runif(30, -.5, 0), runif(55,0,1)))
library(dplyr)
library(stringr)
library(ggplot2)
library(reshape)
# 연도별로 영억 채우기
ggplot(TS,aes(x=date,y=value)) +
geom_line() +
geom_area(data = TS[substr(TS$date,1,4) == "2012",], fill="hotpink", alpha=0.3) +
geom_area(data = filter(TS, str_sub(TS$date,1,4) == "2013"), fill = "royalblue", alpha=0.3) +
geom_area(data = TS[grep("^2014",TS$date),], fill = "gold", alpha=0.3) +
geom_area(data = TS[str_detect(TS$date,"^2015"),], fill = "green", alpha=0.3) +
geom_area(data = TS[grep("[^2012|2013|2014|2015]",substr(TS$date,1,4)),], fill="cyan1", alpha=0.3)
# 0을 기준으로 위아래 다른색 채우기
ggplot(TS, aes(x=date, y=value2)) +
geom_col(data = TS[TS$value <= 0,], fill = "Coral1", alpha = .3) +
geom_col(data = TS[TS$value > 0,], fill = "royalblue1", alpha = .3) +
geom_hline(yintercept = 0, color="black") +
theme_bw()
# 0을 기준으로 위아래 다른색 채우기
ggplot(TS, aes(x=date, y=value)) +
geom_col(data = TS[TS$value <= 0,], fill = "Coral1", alpha = .3) +
geom_col(data = TS[TS$value > 0,], fill = "royalblue1", alpha = .3) +
geom_hline(yintercept = 0, color="black") +
theme_bw()
TS %>% select(date,value) %>%
melt(id=c("date")) %>%
mutate(area = ifelse(value > 0,"up","down")) %>%
ggplot(aes(x=date, y=value)) +
geom_area(aes(fill=area)) +
geom_line() +
geom_hline(yintercept = 0, color='black')
ggplot(TS, aes(x = date, y = value)) +
geom_area(data = subset(TS, value <= 0), fill = "Coral1", alpha=0.3) +
geom_area(data = subset(TS, value >= 0), fill = "cyan", alpha=0.3) +
theme_bw()
TS %>% select(date,value) %>%
melt(id=c("date")) %>%
mutate(area = ifelse(value > 0,"up","down")) %>%
ggplot(aes(x=date, y=value)) +
geom_area(aes(fill=area)) +
geom_line() +
geom_hline(yintercept = 0, color='black')
TS %>% select(date,value) %>%
melt(id=c("date")) %>%
mutate(area = ifelse(value > 0,"up","down")) %>%
ggplot(aes(x=date, y=value)) +
geom_area(aes(fill=area), alpha=0.3) +
geom_line() +
geom_hline(yintercept = 0, color='black')
TS <- data.frame(date = seq(as.Date("2012-01-01"), as.Date("2019-01-01"), by="month"),
value = c(runif(30, -.5, 0), runif(55,0,0.3)))
ggplot(TS,aes(x=date,y=value)) +
geom_line() +
geom_area(data = TS[substr(TS$date,1,4) == "2012",], fill="hotpink", alpha=0.3) +
geom_area(data = filter(TS, str_sub(TS$date,1,4) == "2013"), fill = "royalblue", alpha=0.3) +
geom_area(data = TS[grep("^2014",TS$date),], fill = "gold", alpha=0.3) +
geom_area(data = TS[str_detect(TS$date,"^2015"),], fill = "green", alpha=0.3) +
geom_area(data = TS[grep("[^2012|2013|2014|2015]",substr(TS$date,1,4)),], fill="cyan1", alpha=0.3)
TS <- data.frame(date = seq(as.Date("2012-01-01"), as.Date("2019-01-01"), by="month"),
value = c(runif(30, -.3, 0), runif(55,0,0.3)))
ggplot(TS,aes(x=date,y=value)) +
geom_line() +
geom_area(data = TS[substr(TS$date,1,4) == "2012",], fill="hotpink", alpha=0.3) +
geom_area(data = filter(TS, str_sub(TS$date,1,4) == "2013"), fill = "royalblue", alpha=0.3) +
geom_area(data = TS[grep("^2014",TS$date),], fill = "gold", alpha=0.3) +
geom_area(data = TS[str_detect(TS$date,"^2015"),], fill = "green", alpha=0.3) +
geom_area(data = TS[grep("[^2012|2013|2014|2015]",substr(TS$date,1,4)),], fill="cyan1", alpha=0.3)
ggplot(TS, aes(x=date, y=value)) +
geom_col(data = TS[TS$value <= 0,], fill = "Coral1", alpha = .3) +
geom_col(data = TS[TS$value > 0,], fill = "royalblue1", alpha = .3) +
geom_hline(yintercept = 0, color="black") +
theme_bw()
TS %>% select(date,value) %>%
melt(id=c("date")) %>%
mutate(area = ifelse(value > 0,"up","down")) %>%
ggplot(aes(x=date, y=value)) +
geom_area(aes(fill=area), alpha=0.3) +
geom_line() +
geom_hline(yintercept = 0, color='black')
# 0을 기준으로 위아래 다른색 채우기
# 막대
ggplot(TS, aes(x=date, y=value)) +
geom_col(data = TS[TS$value <= 0,], fill = "Coral1", alpha = .3) +
geom_col(data = TS[TS$value > 0,], fill = "royalblue1", alpha = .3) +
geom_hline(yintercept = 0, color="black") +
theme_bw()
TS %>% select(date,value) %>%
melt(id=c("date")) %>%
mutate(area = ifelse(value > 0,"up","down")) %>%
ggplot(aes(x=date, y=value)) +
geom_area(aes(fill=area), alpha=0.3) +
geom_line() +
geom_hline(yintercept = 0, color='black')
TS %>% select(date,value) %>%
melt(id=c("date")) %>%
mutate(area = ifelse(value > 0,"up","down")) %>%
ggplot(aes(x=date, y=value)) +
geom_area(aes(fill=area), alpha=0.3) +
geom_line() +
geom_hline(yintercept = 0, color='black')
ggplot(TS, aes(x = date, y = value)) +
geom_area(data = subset(TS, value <= 0), fill = "Coral1", alpha=0.3) +
geom_area(data = subset(TS, value >= 0), fill = "cyan", alpha=0.3) +
theme_bw()
# 시계열
TS %>% select(date,value) %>%
melt(id=c("date")) %>%
mutate(area = ifelse(value > 0,"up","down")) %>%
ggplot(aes(x=date, y=value)) +
geom_area(aes(fill=area), alpha=0.3) +
geom_line() +
geom_hline(yintercept = 0, color='black')
Basic_Plot <- ggplot(Cars93, aes(x=Price, y=Horsepower)) + # x: 가격, y: 마력
geom_point(aes(colour=DriveTrain))
library(ggplot2)
Basic_Plot <- ggplot(Cars93, aes(x=Price, y=Horsepower)) + # x: 가격, y: 마력
geom_point(aes(colour=DriveTrain))
library(MASS)
Basic_Plot <- ggplot(Cars93, aes(x=Price, y=Horsepower)) + # x: 가격, y: 마력
geom_point(aes(colour=DriveTrain))
Basic_Plot +
scale_x_continuous(breaks = c(10,20,30,40,50,60))
Basic_Plot +
geom_line()
Cars93
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=MPG.highway))
str(Cars93)
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=MPG.highway)) +
geom_line(aes(y=MPG.city))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=MPG.highway, color="Coral1")) +
geom_line(aes(y=MPG.city), color="Royalblue")
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=wheelbase, color="Coral1")) +
geom_line(aes(y=Weight), color="Royalblue")
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Weight), color="Royalblue")
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Weight), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~./3, name = "Weight"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Weight), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~./4, name = "Weight"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Weight), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~./40, name = "Weight"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Weight), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~./4, name = "Weight"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=EngineSize), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~./4, name = "EngineSize"))
~./4
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=EngineSize), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*4, name = "EngineSize"))
max(Cars93$Wheelbase)/max(Cars93$EngineSize)
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=EngineSize), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*21, name = "EngineSize"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=EngineSize), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(.*21, name = "EngineSize"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=EngineSize), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(EngineSize*21, name = "EngineSize"))
max(Cars93$Wheelbase)/max(Cars93$EngineSize)
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=EngineSize), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*21, name = "EngineSize"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=EngineSize), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~./21, name = "EngineSize"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=EngineSize), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*21, name = "EngineSize"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*21, name = "Rear.seat.room"))
max(Cars93$Wheelbase)/max(Cars93$Rear.seat.room)
max(Cars93$Wheelbase)/max(Cars93$Rear.seat.room)
max(Cars93$Wheelbase)/max(Cars93$Rear.seat.room,na.rm = T)
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*3.3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~./3.3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3.3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*3.3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room/3.3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~./3.3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*3, name = "Rear.seat.room"))
max(Cars93$Wheelbase)
/max(Cars93$Rear.seat.room,na.rm = T)
max(Cars93$Rear.seat.room,na.rm = T)
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*0.3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*0.3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~., name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*3.3, name = "Rear.seat.room"))
max(Cars93$Wheelbase)/max(Cars93$Rear.seat.room,na.rm = T)
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3.3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*3.3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase*10, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3), color="Royalblue") +
scale_y_continuous(sec.axis = sec_axis(~.*0.3, name = "Rear.seat.room"))
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3.3), color="Royalblue") + # Rear.seat.room에 3을 곱한
scale_y_continuous(sec.axis = sec_axis(~.*0.3, name = "Rear.seat.room")) # sec_axis는 첫번째 축을 기준으로 만듦
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*3), color="Royalblue") + # Rear.seat.room에 3을 곱한
scale_y_continuous(sec.axis = sec_axis(~.*0.3, name = "Rear.seat.room")) # sec_axis는 첫번째 축을 기준으로 만듦
max_ratio <- max(Cars93$Wheelbase)/max(Cars93$Rear.seat.room,na.rm = T) # 새로만들 축에 곱할 y1과 y2의 최대치의 비율
ggplot(Cars93, aes(x=Price)) +
geom_line(aes(y=Wheelbase, color="Coral1")) +
geom_line(aes(y=Rear.seat.room*max_ratio), color="Royalblue") + # Rear.seat.room에 3을 곱한 이유는
scale_y_continuous(sec.axis = sec_axis(~.*(max_ratio/10), name = "Rear.seat.room")) # sec_axis는 첫번째 축을 기준으로 만듦
# 연도별로 영억 채우기
ggplot(TS,aes(x=date,y=value)) +
geom_line() +
geom_area(data = TS[substr(TS$date,1,4) == "2012",], fill="hotpink", alpha=0.3) +
geom_area(data = filter(TS, str_sub(TS$date,1,4) == "2013"), fill = "royalblue", alpha=0.3) +
geom_area(data = TS[grep("^2014",TS$date),], fill = "gold", alpha=0.3) +
geom_area(data = TS[str_detect(TS$date,"^2015"),], fill = "green", alpha=0.3) +
geom_area(data = TS[grep("[^2012|2013|2014|2015]",substr(TS$date,1,4)),], fill="cyan1", alpha=0.3)
# 0을 기준으로 위아래 다른색 채우기
# 막대
ggplot(TS, aes(x=date, y=value)) +
geom_col(data = TS[TS$value <= 0,], fill = "Coral1", alpha = .3) +
geom_col(data = TS[TS$value > 0,], fill = "royalblue1", alpha = .3) +
geom_hline(yintercept = 0, color="black") +
theme_bw()
